<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Refines the corner locations."><title>corner_sub_pix in opencv::opencv::hub::imgproc - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../../static.files/rustdoc-dd39b87e5fcfba68.css"><meta name="rustdoc-vars" data-root-path="../../../../" data-static-root-path="../../../../static.files/" data-current-crate="opencv" data-themes="" data-resource-suffix="" data-rustdoc-version="1.80.0 (051478957 2024-07-21)" data-channel="1.80.0" data-search-js="search-d52510db62a78183.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../../../static.files/storage-118b08c4c78b968e.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../../static.files/main-20a3ad099b048cf2.js"></script><noscript><link rel="stylesheet" href="../../../../static.files/noscript-df360f571f6edeae.css"></noscript><link rel="alternate icon" type="image/png" href="../../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../../opencv/index.html">opencv</a><span class="version">0.92.0</span></h2></div><div class="sidebar-elems"><h2><a href="index.html">In opencv::opencv::hub::imgproc</a></h2></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Function <a href="../../../index.html">opencv</a>::<wbr><a href="../../index.html">opencv</a>::<wbr><a href="../index.html">hub</a>::<wbr><a href="index.html">imgproc</a>::<wbr><a class="fn" href="#">corner_sub_pix</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../../../../src/opencv/home/runner/work/SW8S-Rust/SW8S-Rust/target/debug/build/opencv-9ed740593cbedea6/out/opencv/imgproc.rs.html#5405-5413">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub fn corner_sub_pix(
    image: &amp;impl <a class="trait" href="../../../manual/core/input_output_array/trait.ToInputArray.html" title="trait opencv::manual::core::input_output_array::ToInputArray">ToInputArray</a>,
    corners: &amp;mut impl <a class="trait" href="../../../manual/core/input_output_array/trait.ToInputOutputArray.html" title="trait opencv::manual::core::input_output_array::ToInputOutputArray">ToInputOutputArray</a>,
    win_size: <a class="type" href="../core/type.Size.html" title="type opencv::opencv::hub::core::Size">Size</a>,
    zero_zone: <a class="type" href="../core/type.Size.html" title="type opencv::opencv::hub::core::Size">Size</a>,
    criteria: <a class="struct" href="../core/struct.TermCriteria.html" title="struct opencv::opencv::hub::core::TermCriteria">TermCriteria</a>,
) -&gt; <a class="type" href="../../../error/type.Result.html" title="type opencv::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.80.0/std/primitive.unit.html">()</a>&gt;</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Refines the corner locations.</p>
<p>The function iterates to find the sub-pixel accurate location of corners or radial saddle
points as described in <a href="https://docs.opencv.org/4.5.4/d0/de3/citelist.html#CITEREF_forstner1987fast">forstner1987fast</a>, and as shown on the figure below.</p>
<p><img src="https://docs.opencv.org/4.5.4/cornersubpix.png" alt="image" /></p>
<p>Sub-pixel accurate corner locator is based on the observation that every vector from the center <img src="https://latex.codecogs.com/png.latex?q" alt="inline formula" />
to a point <img src="https://latex.codecogs.com/png.latex?p" alt="inline formula" /> located within a neighborhood of <img src="https://latex.codecogs.com/png.latex?q" alt="inline formula" /> is orthogonal to the image gradient at <img src="https://latex.codecogs.com/png.latex?p" alt="inline formula" />
subject to image and measurement noise. Consider the expression:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cepsilon%20%5Fi%20%3D%20%7BDI%5F%7Bp%5Fi%7D%7D%5ET%20%20%5Ccdot%20%28q%20%2D%20p%5Fi%29" alt="block formula" /></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%7BDI%5F%7Bp%5Fi%7D%7D" alt="inline formula" /> is an image gradient at one of the points <img src="https://latex.codecogs.com/png.latex?p%5Fi" alt="inline formula" /> in a neighborhood of <img src="https://latex.codecogs.com/png.latex?q" alt="inline formula" /> . The
value of <img src="https://latex.codecogs.com/png.latex?q" alt="inline formula" /> is to be found so that <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%5Fi" alt="inline formula" /> is minimized. A system of equations may be set up
with <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%5Fi" alt="inline formula" /> set to zero:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Csum%20%5Fi%28DI%5F%7Bp%5Fi%7D%20%20%5Ccdot%20%7BDI%5F%7Bp%5Fi%7D%7D%5ET%29%20%5Ccdot%20q%20%2D%20%20%5Csum%20%5Fi%28DI%5F%7Bp%5Fi%7D%20%20%5Ccdot%20%7BDI%5F%7Bp%5Fi%7D%7D%5ET%20%20%5Ccdot%20p%5Fi%29" alt="block formula" /></p>
<p>where the gradients are summed within a neighborhood (“search window”) of <img src="https://latex.codecogs.com/png.latex?q" alt="inline formula" /> . Calling the first
gradient term <img src="https://latex.codecogs.com/png.latex?G" alt="inline formula" /> and the second gradient term <img src="https://latex.codecogs.com/png.latex?b" alt="inline formula" /> gives:</p>
<p><img src="https://latex.codecogs.com/png.latex?q%20%3D%20G%5E%7B%2D1%7D%20%20%5Ccdot%20b" alt="block formula" /></p>
<p>The algorithm sets the center of the neighborhood window at this new center <img src="https://latex.codecogs.com/png.latex?q" alt="inline formula" /> and then iterates
until the center stays within a set threshold.</p>
<h3 id="parameters"><a class="doc-anchor" href="#parameters">§</a>Parameters</h3>
<ul>
<li>image: Input single-channel, 8-bit or float image.</li>
<li>corners: Initial coordinates of the input corners and refined coordinates provided for
output.</li>
<li>winSize: Half of the side length of the search window. For example, if winSize=Size(5,5) ,
then a <img src="https://latex.codecogs.com/png.latex?%285%2A2%2B1%29%20%5Ctimes%20%285%2A2%2B1%29%20%3D%2011%20%5Ctimes%2011" alt="inline formula" /> search window is used.</li>
<li>zeroZone: Half of the size of the dead region in the middle of the search zone over which
the summation in the formula below is not done. It is used sometimes to avoid possible
singularities of the autocorrelation matrix. The value of (-1,-1) indicates that there is no such
a size.</li>
<li>criteria: Criteria for termination of the iterative process of corner refinement. That is,
the process of corner position refinement stops either after criteria.maxCount iterations or when
the corner position moves by less than criteria.epsilon on some iteration.</li>
</ul>
</div></details></section></div></main></body></html>